### Как сдавать задания

Вы уже изучили блок «Системы управления версиями», и начиная с этого занятия все ваши работы будут приниматься ссылками на .md-файлы, размещённые в вашем публичном репозитории.

Скопируйте в свой .md-файл содержимое этого файла; исходники можно посмотреть [здесь](https://raw.githubusercontent.com/netology-code/sysadm-homeworks/devsys10/04-script-02-py/README.md). Заполните недостающие части документа решением задач (заменяйте `???`, ОСТАЛЬНОЕ В ШАБЛОНЕ НЕ ТРОГАЙТЕ чтобы не сломать форматирование текста, подсветку синтаксиса и прочее, иначе можно отправиться на доработку) и отправляйте на проверку. Вместо логов можно вставить скриншоты по желани.

# Домашнее задание к занятию "4.2. Использование Python для решения типовых DevOps задач"

## Обязательная задача 1

Есть скрипт:
```python
#!/usr/bin/env python3
a = 1
b = '2'
c = a + b
```

### Вопросы:
| Вопрос  | Ответ |
| ------------- | ------------- |
| Какое значение будет присвоено переменной `c`?  | Никакое. Будет ошибка при попытке сложить целочисленную и строковую переменные  |
| Как получить для переменной `c` значение 12?  | Выполнить преобрахование типа int на str для переменной a. Например так: c = str(a) + b  |
| Как получить для переменной `c` значение 3?  | Выполнить преобрахование типа int на str для переменной b. Например так: c = a + int(b)  |

## Обязательная задача 2
Мы устроились на работу в компанию, где раньше уже был DevOps Engineer. Он написал скрипт, позволяющий узнать, какие файлы модифицированы в репозитории, относительно локальных изменений. Этим скриптом недовольно начальство, потому что в его выводе есть не все изменённые файлы, а также непонятен полный путь к директории, где они находятся. Как можно доработать скрипт ниже, чтобы он исполнял требования вашего руководителя?

```python
#!/usr/bin/env python3

import os

bash_command = ["cd ~/netology/sysadm-homeworks", "git status"]
result_os = os.popen(' && '.join(bash_command)).read()
is_change = False
for result in result_os.split('\n'):
    if result.find('modified') != -1:
        prepare_result = result.replace('\tmodified:   ', '')
        print(prepare_result)
        break
```

### Ваш скрипт:
```python
#!/usr/bin/env python3

import os

bash_command = ["cd ~/netology/sysadm-homeworks", "git status"]

# find path
subst=bash_command[0]
path=subst.split(' ')[1]

result_os = os.popen(' && '.join(bash_command)).read()
is_change = False
for result in result_os.split('\n'):
    if result.find('modified') != -1:
            prepare_result = result.replace('\tmodified:   ', '')
            print(path+'/'+prepare_result)
```

### Вывод скрипта при запуске при тестировании:
```
[root@DevOpser temp]# ./dz_4.2_script-2.sh
~/netology/sysadm-homeworks/README.md
~/netology/sysadm-homeworks/test1.md
[root@DevOpser temp]# 
```

## Обязательная задача 3
1. Доработать скрипт выше так, чтобы он мог проверять не только локальный репозиторий в текущей директории, а также умел воспринимать путь к репозиторию, который мы передаём как входной параметр. Мы точно знаем, что начальство коварное и будет проверять работу этого скрипта в директориях, которые не являются локальными репозиториями.

### Ваш скрипт:
```python
#!/usr/bin/env python3

import os
import sys

path=sys.argv[1]
bash_command = ["cd "+path, "git status"]

result_os = os.popen(' && '.join(bash_command)).read()
is_change = False
for result in result_os.split('\n'):
    if result.find('modified') != -1:
            prepare_result = result.replace('\tmodified:   ', '')
            print(path+'/'+prepare_result)
```

### Вывод скрипта при запуске при тестировании:
```
[root@DevOpser temp]# ./dz_4.2_script-3.sh /tempgit
/tempgit/file2.txt
/tempgit/file4.txt
```

## Обязательная задача 4
1. Наша команда разрабатывает несколько веб-сервисов, доступных по http. Мы точно знаем, что на их стенде нет никакой балансировки, кластеризации, за DNS прячется конкретный IP сервера, где установлен сервис. Проблема в том, что отдел, занимающийся нашей инфраструктурой очень часто меняет нам сервера, поэтому IP меняются примерно раз в неделю, при этом сервисы сохраняют за собой DNS имена. Это бы совсем никого не беспокоило, если бы несколько раз сервера не уезжали в такой сегмент сети нашей компании, который недоступен для разработчиков. Мы хотим написать скрипт, который опрашивает веб-сервисы, получает их IP, выводит информацию в стандартный вывод в виде: <URL сервиса> - <его IP>. Также, должна быть реализована возможность проверки текущего IP сервиса c его IP из предыдущей проверки. Если проверка будет провалена - оповестить об этом в стандартный вывод сообщением: [ERROR] <URL сервиса> IP mismatch: <старый IP> <Новый IP>. Будем считать, что наша разработка реализовала сервисы: `drive.google.com`, `mail.google.com`, `google.com`.

### Ваш скрипт:
```python
#!/usr/bin/env python3

import socket
import datetime
import time

# Создаём список ВЕБ-сервисов
hostnames = ("drive.google.com", "mail.google.com", "google.com")

# Объявляем списки для хранения ip-адресов
ipaddrs_old = ["","",""]
ipaddrs_current = ["","",""]

print("Сервисы, поставленные на мониторинг:")

for host in hostnames:
    print (host)

print("\nНачальные адреса определены:")

for (index,host) in enumerate(hostnames):
    ipaddrs_old[index]=socket.gethostbyname(hostnames[index])
    print (hostnames[index]," -  ",ipaddrs_old[index])

print("\nНачинаем отслеживание изменений в резолвинге ДНС адресов сервисов:")

while (1==1):
    for (index,host) in enumerate(hostnames):
        ipaddrs_current[index]=socket.gethostbyname(hostnames[index])

        if (ipaddrs_current[index] != ipaddrs_old[index]):
            now = datetime.datetime.now()
            print (str(now)," [ERROR] ",hostnames[index]," IP mismatch: ",ipaddrs_old[index]," ",ipaddrs_current[index])
            ipaddrs_old[index]=ipaddrs_current[index]
    time.sleep(3)
```

### Вывод скрипта при запуске при тестировании:
```
[root@DevOpser temp]# ./dz_4.2_script-4.sh
Сервисы, поставленные на мониторинг:
drive.google.com
mail.google.com
google.com

Начальные адреса определены:
drive.google.com  -   142.250.186.142
mail.google.com  -   142.250.185.197
google.com  -   142.250.74.206

Начинаем отслеживание изменений в резолвинге ДНС адресов сервисов:
2021-12-15 11:37:17.053116  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:37:20.221234  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:37:29.723391  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:37:32.899334  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:46:19.039669  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:46:25.382360  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:49:22.871537  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:49:26.040319  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:49:35.553878  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:49:38.667450  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:49:38.722463  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:49:41.833924  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:49:51.337816  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:49:54.505274  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:49:54.560477  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:49:57.674177  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:49:57.729439  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:50:00.842520  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:50:10.413876  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:50:13.589603  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:50:26.262093  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:50:29.438590  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:50:35.773306  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:50:38.885834  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:50:42.054099  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:50:42.109062  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:50:48.443209  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:50:54.778146  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:51:04.281309  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:51:07.447847  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:51:16.896390  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:51:20.063324  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:51:23.286600  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:51:26.453181  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:51:39.124295  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:51:42.291319  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:51:45.459224  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:51:48.635532  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:52:17.087005  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:52:20.247224  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:52:20.300075  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:52:23.410624  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:52:23.461976  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:52:26.570009  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:52:26.621144  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:52:29.784347  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:52:36.110029  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:52:39.279414  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:52:42.442221  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:52:45.604365  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:52:48.713961  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:52:51.873076  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:52:51.926348  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:52:55.035114  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:52:58.192768  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:53:01.405737  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:53:04.513715  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:53:04.567443  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:53:07.673998  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:53:07.725695  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:53:13.991563  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:53:17.154476  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:53:20.368781  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:53:23.529231  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:53:26.689858  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:53:29.817325  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:53:29.870980  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:53:32.979388  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:53:33.030819  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:53:36.200103  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:53:39.357254  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:53:42.515012  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:53:45.682230  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:53:52.017806  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:54:01.449588  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:54:01.503107  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:54:04.612247  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:54:04.663524  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 11:54:07.781024  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 11:54:14.130860  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 11:54:33.151049  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 11:54:36.318428  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 12:00:46.342486  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 12:00:49.504002  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 12:09:12.362750  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 12:09:15.522039  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 12:11:12.581980  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 12:11:15.739395  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 12:11:44.148436  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   172.217.18.101
2021-12-15 12:11:47.306854  [ERROR]  mail.google.com  IP mismatch:  172.217.18.101   142.250.185.197
2021-12-15 12:16:09.840119  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   142.250.185.165
2021-12-15 12:16:13.001168  [ERROR]  mail.google.com  IP mismatch:  142.250.185.165   142.250.185.197
2021-12-15 12:16:19.326396  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   142.250.185.165
2021-12-15 12:16:22.486037  [ERROR]  mail.google.com  IP mismatch:  142.250.185.165   142.250.185.197
2021-12-15 12:17:06.761099  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   142.250.185.165
2021-12-15 12:17:09.924207  [ERROR]  mail.google.com  IP mismatch:  142.250.185.165   142.250.185.197
2021-12-15 12:20:03.887057  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   142.250.185.165
2021-12-15 12:20:07.046130  [ERROR]  mail.google.com  IP mismatch:  142.250.185.165   142.250.185.197
2021-12-15 12:20:22.903257  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 12:20:26.062108  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 12:20:29.222835  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 12:20:32.385561  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 12:20:35.494547  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   142.250.185.165
2021-12-15 12:20:38.676433  [ERROR]  mail.google.com  IP mismatch:  142.250.185.165   142.250.185.197
2021-12-15 12:20:45.049832  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 12:20:48.210595  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 12:20:51.316896  [ERROR]  mail.google.com  IP mismatch:  142.250.185.197   142.250.185.165
2021-12-15 12:20:57.658178  [ERROR]  mail.google.com  IP mismatch:  142.250.185.165   142.250.185.197
2021-12-15 12:21:04.041434  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
2021-12-15 12:21:07.211002  [ERROR]  google.com  IP mismatch:  142.250.185.174   142.250.74.206
2021-12-15 12:21:13.534594  [ERROR]  google.com  IP mismatch:  142.250.74.206   142.250.185.174
```

## Дополнительное задание (со звездочкой*) - необязательно к выполнению

Так получилось, что мы очень часто вносим правки в конфигурацию своей системы прямо на сервере. Но так как вся наша команда разработки держит файлы конфигурации в github и пользуется gitflow, то нам приходится каждый раз переносить архив с нашими изменениями с сервера на наш локальный компьютер, формировать новую ветку, коммитить в неё изменения, создавать pull request (PR) и только после выполнения Merge мы наконец можем официально подтвердить, что новая конфигурация применена. Мы хотим максимально автоматизировать всю цепочку действий. Для этого нам нужно написать скрипт, который будет в директории с локальным репозиторием обращаться по API к github, создавать PR для вливания текущей выбранной ветки в master с сообщением, которое мы вписываем в первый параметр при обращении к py-файлу (сообщение не может быть пустым). При желании, можно добавить к указанному функционалу создание новой ветки, commit и push в неё изменений конфигурации. С директорией локального репозитория можно делать всё, что угодно. Также, принимаем во внимание, что Merge Conflict у нас отсутствуют и их точно не будет при push, как в свою ветку, так и при слиянии в master. Важно получить конечный результат с созданным PR, в котором применяются наши изменения. 

### Ваш скрипт:
```python
???
```

### Вывод скрипта при запуске при тестировании:
```
???
```